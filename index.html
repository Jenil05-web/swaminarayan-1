<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Dynamic Expiring QR Code</title>
  <!-- Include the QRCode.js library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script>
    // Function to generate a random token.
    function generateToken() {
      return Math.random().toString(36).substr(2, 9);
    }

    // Function to generate the QR code.
    function generateQRCode() {
      const qrContainer = document.getElementById("qrContainer");
      qrContainer.innerHTML = ""; // Clear the previous QR code

      // Generate a new token and set the expiry (20 seconds from now).
      const token = generateToken();
      const expiry = Date.now() + 20000; // 20 seconds

      // Define the constant base Google Form URL.
      const baseFormUrl = "YOUR_NEW_GOOGLE_FORM_URL";
      
      // Create the dynamic URL by appending token and expiry (even though the base remains constant).
      const dynamicUrl = baseFormUrl + "&token=" + token + "&expiry=" + expiry;
      
      // Generate the QR code with the dynamic URL.
      new QRCode(qrContainer, {
        text: dynamicUrl,
        width: 200,
        height: 200,
        correctLevel: QRCode.CorrectLevel.H
      });

      // Optionally, display the expiry time on the page.
      document.getElementById("expiryDisplay").innerText =
        "QR Code expires at: " + new Date(expiry).toLocaleTimeString();

      console.log("Generated QR code URL:", dynamicUrl);
    }

    // When the window loads, generate the QR code and then refresh it every 20 seconds.
    window.onload = function() {
      generateQRCode();
      setInterval(generateQRCode, 20000);
    };
  </script>
</head>
<body>
  <h1>Dynamic Expiring QR Code</h1>
  <p>
    Scan the QR code below. It refreshes every 20 seconds. While the dynamic token and expiry parameters change, the base link (your Google Form) remains the same.
  </p>
  <div id="qrContainer"></div>
  <p id="expiryDisplay"></p>
</body>
</html>
