<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Scan Here for Entry Details</title>
  <!-- Include the QRCode.js library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script>
    // Function to generate a random alphanumeric token.
    function generateToken() {
      return Math.random().toString(36).substr(2, 9);
    }
    
    // Function to generate both QR codes.
    function generateQRCodes() {
      // --------- Generate First QR Code (scan.html) --------- //
      const qrContainer1 = document.getElementById("qrContainer1");
      qrContainer1.innerHTML = ""; // Clear previous QR code
      
      const token1 = generateToken();
      const expiry1 = Date.now() + 20000; // 20 seconds from now
      
      // Use your GitHub Pages base URL (adjust if needed)
      const baseUrl = "https://Jenil05-web.github.io/swaminarayan-1/";
      // Build the URL that points to scan.html including token and expiry.
      const scanURL1 = baseUrl + "scan.html?token=" + token1 + "&expiry=" + expiry1;
      
      new QRCode(qrContainer1, {
        text: scanURL1,
        width: 200,
        height: 200,
        correctLevel: QRCode.CorrectLevel.H
      });
      
      document.getElementById("expiryDisplay1").innerText =
        "First QR code expires at: " + new Date(expiry1).toLocaleTimeString();
      
      console.log("Generated First QR Code URL:", scanURL1);
      
      // --------- Generate Second QR Code (scan2.html) --------- //
      const qrContainer2 = document.getElementById("qrContainer2");
      qrContainer2.innerHTML = ""; // Clear previous QR code
      
      const token2 = generateToken();
      const expiry2 = Date.now() + 20000; // 20 seconds from now
      
      // Build the URL that points to scan2.html including token and expiry.
      const scanURL2 = baseUrl + "scan2.html?token=" + token2 + "&expiry=" + expiry2;
      
      new QRCode(qrContainer2, {
        text: scanURL2,
        width: 200,
        height: 200,
        correctLevel: QRCode.CorrectLevel.H
      });
      
      document.getElementById("expiryDisplay2").innerText =
        "Second QR code expires at: " + new Date(expiry2).toLocaleTimeString();
      
      console.log("Generated Second QR Code URL:", scanURL2);
    }
    
    // Generate the QR codes when the window loads and every 20 seconds thereafter.
    window.onload = function() {
      generateQRCodes();
      setInterval(generateQRCodes, 20000);
    };
  </script>
</head>
<body>
  <h1>Scan Here for Entry Details</h1>
  
  <!-- First QR Code Section -->
  <h2>First QR Code</h2>
  <p>Scan this QR code with your mobile device to open the first Google Form.</p>
  <div id="qrContainer1"></div>
  <p id="expiryDisplay1"></p>
  
  <!-- Second QR Code Section -->
  <h2>Second QR Code</h2>
  <p>Scan this QR code with your mobile device to open the second Google Form.</p>
  <div id="qrContainer2"></div>
  <p id="expiryDisplay2"></p>
</body>
</html>
