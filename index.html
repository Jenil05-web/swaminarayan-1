<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Scan Here to exit the Chatralay</title>
  <!-- Include the QRCode.js library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script>
    let expiryTime = Date.now() + 20000; // Set expiry time for first QR code

    function generateToken() {
      return Math.random().toString(36).substr(2, 9);
    }

    function generateQRCodes() {
      const qrContainer1 = document.getElementById("qrContainer1");
      const qrContainer2 = document.getElementById("qrContainer2");
      qrContainer1.innerHTML = ""; // Clear previous QR code
      qrContainer2.innerHTML = ""; // Clear previous QR code

      const token = generateToken();
      expiryTime = Date.now() + 20000; // Reset expiry time every 20 sec

      const baseUrl = "https://Jenil05-web.github.io/swaminarayan-1/";
      const scanURL1 = "YOUR_NEW_GOOGLE_FORM_URL"; // Updated link for existing QR
      const scanURL2 = "ANOTHER_GOOGLE_FORM_URL"; // Link for new QR

      // Display expiry information
      document.getElementById('expiryDisplay').innerText =
        "Expires at: " + new Date(expiryTime).toLocaleTimeString();

      // Generate the QR codes
      new QRCode(qrContainer1, {
        text: scanURL1,
        width: 200,
        height: 200,
        correctLevel: QRCode.CorrectLevel.H
      });

      new QRCode(qrContainer2, {
        text: scanURL2,
        width: 200,
        height: 200,
        correctLevel: QRCode.CorrectLevel.H
      });

      console.log("Generated QR Code URLs:", scanURL1, scanURL2);
    }

    function checkExpiry() {
      if (Date.now() > expiryTime) {
        document.getElementById("qrContainer1").innerHTML = "<p>QR Code Expired. Generating new...</p>";
        document.getElementById("qrContainer2").innerHTML = "<p>QR Code Expired. Generating new...</p>";
        generateQRCodes();
      }
    }

    window.onload = function() {
      generateQRCodes();
      setInterval(checkExpiry, 5000); // Check every 5 seconds
      setInterval(generateQRCodes, 20000); // Generate new QR codes every 20 sec
    };

  </script>
</head>
<body>
  <h1>Scan Here for Entry Details</h1>
  <p>Scan the QR codes below:</p>

  <h3>Existing QR Code</h3>
  <div id="qrContainer1"></div>

  <h3>New QR Code</h3>
  <div id="qrContainer2"></div>

  <p id="expiryDisplay"></p>
</body>
</html>
